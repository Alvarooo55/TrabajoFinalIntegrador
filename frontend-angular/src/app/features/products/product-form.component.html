<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h4 mb-0">{{ isEditMode ? 'Editar producto' : 'Crear producto' }}</h1>
  <a class="btn btn-outline-secondary" routerLink="/productos">Volver</a>
</div>

<div *ngIf="alertMessage" class="alert" [ngClass]="alertType === 'success' ? 'alert-success' : 'alert-danger'" role="alert">
  {{ alertMessage }}
</div>

<div *ngIf="loading" class="text-center py-4">
  <div class="spinner-border" role="status"></div>
</div>

<form *ngIf="!loading" [formGroup]="form" (ngSubmit)="submit()" class="card">
  <div class="card-body">
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">Nombre</label>
        <input class="form-control" type="text" formControlName="nombre" />
        <div class="text-danger small" *ngIf="form.controls.nombre.touched && form.controls.nombre.invalid">
          Nombre requerido (3 a 120 caracteres)
        </div>
      </div>

      <div class="col-md-6">
        <label class="form-label">Categoría</label>
        <select class="form-select" formControlName="categoria">
          <option value="">Selecciona una categoría</option>
          <option *ngFor="let category of categories" [value]="category" class="text-capitalize">
            {{ category }}
          </option>
        </select>
        <div class="text-danger small" *ngIf="form.controls.categoria.touched && form.controls.categoria.invalid">
          Categoría requerida
        </div>
      </div>

      <div class="col-12">
        <label class="form-label">Descripción</label>
        <textarea class="form-control" rows="3" formControlName="descripcion"></textarea>
        <div class="text-danger small" *ngIf="form.controls.descripcion.touched && form.controls.descripcion.invalid">
          Descripción requerida (10 a 500 caracteres)
        </div>
      </div>

      <div class="col-md-4">
        <label class="form-label">Precio</label>
        <input class="form-control" type="number" formControlName="precio" min="1" max="10000" step="0.01" />
        <div class="text-danger small" *ngIf="form.controls.precio.touched && form.controls.precio.invalid">
          Precio entre 1 y 10000
        </div>
      </div>

      <div class="col-md-4">
        <label class="form-label">Fecha de ingreso</label>
        <input class="form-control" type="date" formControlName="fechaIngreso" />
        <div class="text-danger small" *ngIf="form.controls.fechaIngreso.touched && form.controls.fechaIngreso.invalid">
          Fecha requerida
        </div>
      </div>

      <div class="col-md-4">
        <label class="form-label">Stock</label>
        <input class="form-control" type="number" formControlName="stock" min="0" step="1" />
        <div class="text-danger small" *ngIf="form.controls.stock.touched && form.controls.stock.invalid">
          Stock entero mayor o igual a 0
        </div>
      </div>

      <div class="col-12">
        <div class="form-check">
          <input id="activo" class="form-check-input" type="checkbox" formControlName="activo" />
          <label for="activo" class="form-check-label">Producto activo</label>
        </div>
      </div>
    </div>
  </div>

  <div class="card-footer d-flex justify-content-end gap-2">
    <a class="btn btn-outline-secondary" routerLink="/productos">Cancelar</a>
    <button class="btn btn-primary" type="submit" [disabled]="loading">
      {{ isEditMode ? 'Actualizar' : 'Crear' }}
    </button>
  </div>
</form>
